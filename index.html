<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Giáng Sinh An Lành</title>

<style>
body{
    margin:0;
    overflow:hidden;
    background:black;
    font-family:'Cinzel','Times New Roman',serif;
}

/* ===== HEADER ===== */
#ui{
    position:fixed;
    top:30px;
    width:100%;
    text-align:center;
    z-index:10;
    pointer-events:none;
}
#title{
    font-size:56px;
    letter-spacing:6px;
    background:linear-gradient(to bottom,#fff,#eebb66);
    -webkit-background-clip:text;
    -webkit-text-fill-color:transparent;
    text-shadow:0 0 40px rgba(255,220,150,.6);
    animation:
        glow 4s linear infinite,
        shake 2.8s ease-in-out infinite;
}

/* ===== SUBTITLE DƯỚI CÂY ===== */
#treeText{
    position:fixed;
    bottom:55px; /* ⬅️ HẠ THẤP HƠN */
    width:100%;
    text-align:center;
    font-size:18px;
    letter-spacing:2px;
    color:rgba(255,220,170,0.9);
    font-style:italic;
    text-shadow:0 0 25px rgba(255,200,120,.5);
    animation:float 3.5s ease-in-out infinite;
    pointer-events:none;
    z-index:8;
}

/* ===== UPLOAD ===== */
#upload{
    position:fixed;
    bottom:20px;
    left:20px;
    z-index:10;
}
#upload label{
    color:gold;
    font-size:12px;
    cursor:pointer;
    border:1px solid gold;
    padding:8px 14px;
    border-radius:8px;
}
#upload input{display:none}

/* ===== SNOW ===== */
.snow{
    position:fixed;
    top:-10px;
    background:white;
    border-radius:50%;
    opacity:.8;
    pointer-events:none;
    animation:snow linear infinite;
}
@keyframes snow{
    to{ transform:translate(-100px,110vh); }
}

/* ===== TEXT ANIM ===== */
@keyframes glow{
    0%{filter:hue-rotate(0deg)}
    50%{filter:hue-rotate(40deg)}
    100%{filter:hue-rotate(0deg)}
}
@keyframes shake{
    0%{transform:translate(0,0)}
    25%{transform:translate(0.6px,-0.4px)}
    50%{transform:translate(-0.6px,0.4px)}
    75%{transform:translate(0.4px,0.6px)}
    100%{transform:translate(0,0)}
}
@keyframes float{
    0%{transform:translateY(0)}
    50%{transform:translateY(-4px)}
    100%{transform:translateY(0)}
}

canvas{display:block}
</style>

<link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700&display=swap" rel="stylesheet">
</head>

<body>

<div id="ui">
    <div id="title">GIÁNG SINH AN LÀNH</div>
</div>

<div id="treeText">TRĂM NĂM HẠNH PHÚC</div>

<div id="upload">
    <label>
        Thêm ảnh
        <input type="file" id="fileInput" multiple accept="image/*">
    </label>
</div>

<canvas id="canvas"></canvas>

<script type="module">
import * as THREE from "https://cdn.jsdelivr.net/npm/three@0.160.0/build/three.module.js";

const canvas=document.getElementById("canvas");
const renderer=new THREE.WebGLRenderer({canvas,antialias:true});
renderer.setSize(innerWidth,innerHeight);
renderer.setPixelRatio(devicePixelRatio);

const scene=new THREE.Scene();
scene.background=new THREE.Color(0x000000);

const camera=new THREE.PerspectiveCamera(45,innerWidth/innerHeight,0.1,1000);
camera.position.z=40;

const group=new THREE.Group();
scene.add(group);

scene.add(new THREE.AmbientLight(0xffffff,.8));
const light=new THREE.PointLight(0xffcc66,2,50);
light.position.set(0,10,10);
scene.add(light);

/* TREE */
const treeH=20;
for(let i=0;i<1800;i++){
    const y=Math.random()*treeH-treeH/2;
    const r=(1-(y+treeH/2)/treeH)*8;
    const a=Math.random()*Math.PI*2;
    const m=new THREE.Mesh(
        new THREE.SphereGeometry(.18,12,12),
        new THREE.MeshStandardMaterial({
            color:Math.random()>.75?0xff3333:0xffdd88,
            emissive:0x331100
        })
    );
    m.position.set(Math.cos(a)*r,y,Math.sin(a)*r);
    group.add(m);
}

/* STAR */
const star=new THREE.Mesh(
    new THREE.OctahedronGeometry(1.2),
    new THREE.MeshStandardMaterial({
        color:0xffee99,
        emissive:0xffaa00
    })
);
star.position.y=treeH/2+1.5;
group.add(star);

/* PHOTOS */
const photoGroup=new THREE.Group();
group.add(photoGroup);

function addPhoto(tex){
    const frame=new THREE.Mesh(
        new THREE.BoxGeometry(1.6,1.6,.05),
        new THREE.MeshStandardMaterial({
            color:0xffd966,
            metalness:1,
            roughness:.2
        })
    );

    const img=new THREE.Mesh(
        new THREE.PlaneGeometry(1.4,1.4),
        new THREE.MeshBasicMaterial({
            map:tex,
            side:THREE.DoubleSide
        })
    );
    img.position.z=.03;

    const g=new THREE.Group();
    g.add(frame);
    g.add(img);
    g.scale.set(1.4,1.4,1.4);

    const y=Math.random()*treeH-treeH/2;
    const r=(1-(y+treeH/2)/treeH)*8;
    const a=Math.random()*Math.PI*2;
    g.position.set(Math.cos(a)*r,y,Math.sin(a)*r);

    photoGroup.add(g);
}

fileInput.onchange=e=>{
    [...e.target.files].forEach(f=>{
        const r=new FileReader();
        r.onload=ev=>{
            new THREE.TextureLoader().load(ev.target.result,t=>{
                t.colorSpace=THREE.SRGBColorSpace;
                addPhoto(t);
            });
        };
        r.readAsDataURL(f);
    });
};

function animate(){
    requestAnimationFrame(animate);
    group.rotation.y+=.002;
    renderer.render(scene,camera);
}
animate();

onresize=()=>{
    camera.aspect=innerWidth/innerHeight;
    camera.updateProjectionMatrix();
    renderer.setSize(innerWidth,innerHeight);
};

/* SNOW */
for(let i=0;i<120;i++){
    const s=document.createElement("div");
    s.className="snow";
    const size=Math.random()*4+2;
    s.style.width=size+"px";
    s.style.height=size+"px";
    s.style.left=Math.random()*innerWidth+"px";
    s.style.animationDuration=5+Math.random()*6+"s";
    s.style.opacity=Math.random();
    document.body.appendChild(s);
}
</script>

</body>
</html>
